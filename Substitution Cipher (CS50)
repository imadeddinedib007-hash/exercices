#include <stdio.h>
#include <cs50.h>
#include <string.h>
#include <ctype.h>
int main (int argc, char *argv[]){
    int i=0, j=0;
    if (argc < 2){
        printf("usage : ./substitution key\n");
        return 1;
    }
    else if (argc >2){
        printf("enter only ONE key !\n");
        return 1;
    }
    else {
        char *key = argv[1];
        for (i=0; key[i]!='\0'; i++){
            if (!isalpha(key[i])){
            printf("Key must only cantain alphabets !\n");
            return 1;
        }
            key[i]=toupper(key[i]);
        }
        if (strlen(key) != 26) {
            printf("the key must contain 26 different letters !\n");
            return 1;
        }
        else {
            for (i=0; key[i]!='\0'; i++){
                for (j=i+1; key[j]!='\0'; j++){
                    if (toupper(key[i]) == toupper(key[j])){
                        printf("the key must not contain repeated letters !\n");
                        return 1;
                    }
                }
            }
            for (i=0; key[i]!='\0'; i++){
                if (strlen(key) != 26 ){
            printf("the key must contain 26 different letters !\n");
            return 1;
                }
            }
            string text = get_string("plaintext : ");
            for (i=0; text[i]!='\0'; i++){
                if (text[i]>='A' && text[i]<='Z'){
                    for (j='A'; j<='Z'; j++){
                       if (j == text [i]){
                          int pos = text[i] - 'A';
                          text[i] = toupper(key[pos]);
                          break;
                       }
                    }
                }
                else if (text[i]>='a' && text[i]<='z'){
                    for (j='a'; j<='z'; j++){
                        if (j == text[i]){
                            int pos = text[i] - 'a';
                            text[i] = tolower(key[pos]);
                            break;
                        }
                    }
                }
            }
            printf("ciphertext: %s\n",text);
        }
    }
}
